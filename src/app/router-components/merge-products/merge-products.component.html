<div class="content" #container>
  <div class="top-bar" #topBar [@hideWhileScrolling] = "hideSearchBar ? 'hidden': 'showed'"
   [ngStyle]="{'top': this.container.offsetTop + 2 + 'px'}">
    <div class="top-bar__content">
      <div class="p-input-icon-right top-bar__searcher">
        <input class="top-bar__searcher-input" placeholder="wyszukiwanie" type="text" pInputText
         [(ngModel)]="this.productsParams.searchPhrase" (ngModelChange)="this.onSearchPhraseChanged($event)">
        <i class="pi pi-search"></i>
      </div>
      <shop-sort-select class="top-bar__sorting" placeholder="Sortowanie" optionLabel="name"
       [(ngModel)]="this.productsParams.sort" (ngModelChange)="this.onParamsModelChange()"></shop-sort-select>
      <shop-page-select class="top-bar__page-select" [totalPages]="this.httpResponse.totalPages"
       [(ngModel)]="this.productsParams.pageNumber" (ngModelChange)="this.onParamsModelChange()"></shop-page-select>
      <div class="top-bar__filters-icon" (click) = "this.openFiltersDialog()">
        <p>Filtry</p>
        <i class="pi pi-filter"></i>
      </div>
    </div>
  </div>

  <div class="main">
    <shop-products-filters (ngModelChange)="this.onParamsModelChange()" class="main-filters"
      [(ngModel)]="this.productsParams" (startChanging)="this.cancelPreviousRequest()"></shop-products-filters>
    <div class="main-tiles">
      <shop-busy-overlay *ngIf="this.waitingForResponse" class="main-tiles__overlay"></shop-busy-overlay>
      <ng-container *ngIf="this.httpResponse">
        <ng-container *ngFor="let product of this.httpResponse.result; trackBy: trackByProductId">
          <shop-product-tile class="main-tiles__tile" [product]="product" (click)="this.navigateToProduct(product.id)">
          </shop-product-tile>
        </ng-container>
      </ng-container>
    </div>
  </div>

  <div class="bottom">
    <shop-page-select class="bottom__page-select" [totalPages]="this.httpResponse.totalPages"
     [(ngModel)]="this.productsParams.pageNumber" (ngModelChange)="this.onParamsModelChange()"></shop-page-select>
    <div class="bottom__page-count">
      <p>Produkty na stronie:</p>
      <p-dropdown class="bottom__dropdown" [options]="this.pageOptions"
       [(ngModel)]="this.productsParams.pageSize" (ngModelChange)="this.onParamsModelChange()"></p-dropdown>
    </div>
  </div>

  <shop-filters-dialog [(visibility)]="this.filtersExpanded" [(ngModel)] = "this.productsParams"
   (ngModelChange)="this.onParamsModelChange()"></shop-filters-dialog>
  
  <shop-scroller></shop-scroller>
</div>